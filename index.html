<!doctype html>
<html lang="es">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Registro de Gimnasio — Pro</title>
    <meta name="description" content="Registro y seguimiento de ejercicios con gráficos, metas, RPE, estadísticas mensuales y backup en la nube (Firebase optional)">
    <meta name="author" content="Tu Nombre / Equipo">
    <meta property="og:type" content="website">
    <meta property="og:title" content="Registro de Gimnasio — Pro">
    <meta property="og:description" content="Seguimiento profesional de entrenamientos, gráficos y backups en la nube.">
    <meta property="og:image" content="/assets/og-image.png">
    <meta property="og:url" content="https://tusitio.com">
    <link rel="icon" href="/assets/favicon-32.png" sizes="32x32">
    <link rel="apple-touch-icon" href="/assets/apple-touch-icon.png" sizes="180x180">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Poppins:wght@600;700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="app" id="appRoot">
        <header>
            <div>
                <h1 id="welcomeTitle">Registro de Gimnasio — Pro</h1>
                <div class="sub">Diseñado para entrenadores y atletas — limpio, profesional y listo para publicar</div>
            </div>
            <div style="display:flex;align-items:center;gap:8px">
                <button id="themeToggle" class="theme-toggle" title="Cambiar tema">Modo Claro</button>
                <button id="signBtn" class="small">Registrar/Iniciar Sesión</button>
                <button id="syncNow" class="ghost small" style="display:none">Sincronizar</button>
                <button id="logout" class="ghost small" style="display:none">Cerrar sesión</button>
            </div>
        </header>

        <div class="grid">
            <div>
                <section class="card" aria-label="Añadir entrada">
                    <form id="entryForm">
                        <div>
                            <label for="exerciseInput">Ejercicio</label>
                            <input id="exerciseInput" type="text" placeholder="Ej: Sentadilla" required />
                        </div>

                        <div class="weight-wrap">
                            <label for="weightInput">Peso (kg)</label>
                            <div class="weight-top">
                                <div class="weight-display" id="weightDisplay">20 kg</div>
                                <div style="flex:1">
                                    <div style="display:flex;gap:8px;align-items:center">
                                        <input id="weightInput" class="weight-input" type="number" step="0.5" min="0" value="20" />
                                        <div class="weight-controls">
                                            <button type="button" class="step-btn" id="decWeightBtn">−</button>
                                            <button type="button" class="step-btn" id="incWeightBtn">+</button>
                                        </div>
                                    </div>
                                    <input id="weightSlider" class="weight-slider" type="range" min="0" max="300" step="0.5" value="20" />
                                </div>
                            </div>
                        </div>

                        <div class="row" style="margin-top:8px">
                            <div style="width:120px">
                                <label for="repsInput">Reps</label>
                                <input id="repsInput" type="number" min="0" value="8" />
                            </div>
                            <div style="width:120px">
                                <label for="rpeInput">RPE</label>
                                <input id="rpeInput" type="number" min="1" max="10" value="7" />
                            </div>
                            <div style="width:150px">
                                <label for="dateInput">Fecha</label>
                                <input id="dateInput" type="date" />
                            </div>
                        </div>

                        <div>
                            <label for="noteInput">Nota (opcional)</label>
                            <textarea id="noteInput" rows="2" placeholder="p. ej. sintió molestia, tempo, pausa"></textarea>
                        </div>
                        
                        <div style="display:flex;flex-direction:column;gap:8px;margin-top:8px">
                            <button id="addBtn" type="submit" class="full-width-btn">Agregar registro</button>
                            <div style="display:flex;gap:8px">
                                <button id="exportCSV" type="button" class="ghost small">Exportar CSV</button>
                                <button id="exportJSON" type="button" class="ghost small">Backup JSON</button>
                            </div>
                        </div>
                    </form>
                </section>

                <section class="card" style="margin-top:12px">
                    <h3 style="margin:0 0 8px 0">Metas por ejercicio</h3>
                    <div id="goalsList" class="ex-list"></div>
                    <div class="goal-form-container">
                        <div class="goal-input-group">
                            <label for="goalExerciseInput" class="meta">Ejercicio</label>
                            <input id="goalExerciseInput" placeholder="Ejercicio" />
                        </div>
                        <div class="goal-input-group">
                            <label for="goalTargetInput" class="meta">Meta (kg)</label>
                            <input id="goalTargetInput" placeholder="Meta" type="number" />
                        </div>
                        <button id="addGoalBtn" class="small">Agregar</button>
                    </div>
                </section>
            </div>

            <div>
                <section class="card">
                    <div style="display:flex;justify-content:space-between;align-items:center">
                        <h2 style="margin:0">Progreso por ejercicio</h2>
                        <div style="display:flex;gap:10px;align-items:center">
                            <div>
                                <label class="meta">Periodo</label>
                                <select id="filterWeek"></select>
                            </div>
                            <div>
                                <label class="meta">Vista</label>
                                <select id="viewMode">
                                    <option value="weekly">Semanal</option>
                                    <option value="monthly">Mensual</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div id="exercises" class="ex-list" style="margin-top:12px"></div>
                    <div class="stats" id="quickStats"></div>
                </section>

                <section class="card bottom">
                    <h3>Gráfico de progreso</h3>
                    <div class="chart-card">
                        <canvas id="progressChart" height="240" aria-label="Gráfico de progreso"></canvas>
                    </div>
                    <div style="margin-top:8px;display:flex;gap:8px;align-items:center">
                        <label class="meta">Seleccionar ejercicio</label>
                        <select id="chartExercise"></select>
                        <button id="downloadChart" class="ghost small">Descargar imagen</button>
                    </div>
                    <div id="trendPerc" class="meta" style="margin-top:8px"></div>
                </section>
            </div>
        </div>

        <footer>Los datos se guardan localmente. Para backup en la nube, debes iniciar sesión.</footer>
    </div>
    
    <div class="modal-overlay" id="authModal" aria-hidden="true">
        <div class="modal-content">
            <button class="modal-close" id="closeAuthModal" aria-label="Cerrar">&times;</button>
            <div id="authLogin">
                <h2>Iniciar Sesión</h2>
                <form id="loginForm">
                    <div>
                        <label for="loginEmail">Email</label>
                        <input id="loginEmail" type="email" required />
                    </div>
                    <div>
                        <label for="loginPassword">Contraseña</label>
                        <input id="loginPassword" type="password" required />
                    </div>
                    <button type="submit">Iniciar Sesión</button>
                </form>
                <div class="toggle-link">
                    ¿No tienes cuenta? <button type="button" id="switchToRegister" class="btn-inline">Regístrate</button>
                </div>
            </div>
            <div id="authRegister" style="display:none;">
                <h2>Registrarse</h2>
                <form id="registerForm">
                    <div>
                        <label for="registerEmail">Email</label>
                        <input id="registerEmail" type="email" required />
                    </div>
                    <div>
                        <label for="registerPassword">Contraseña</label>
                        <input id="registerPassword" type="password" required />
                    </div>
                    <div>
                        <label for="registerUsername">Nombre Completo</label>
                        <input id="registerUsername" type="text" required />
                    </div>
                    <div class="row">
                        <div style="flex: 1;">
                            <label for="registerAge">Edad</label>
                            <input id="registerAge" type="number" min="0" max="150" required />
                        </div>
                        <div style="flex: 1;">
                            <label for="registerWeight">Peso (kg)</label>
                            <input id="registerWeight" type="number" step="0.1" min="0" required />
                        </div>
                        <div style="flex: 1;">
                            <label for="registerHeight">Altura (cm)</label>
                            <input id="registerHeight" type="number" min="0" required />
                        </div>
                    </div>
                    <button type="submit">Crear Cuenta</button>
                </form>
                <div class="toggle-link">
                    ¿Ya tienes cuenta? <button type="button" id="switchToLogin" class="btn-inline">Inicia sesión</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="historyModal" aria-hidden="true">
        <div class="modal-content" role="dialog" aria-modal="true">
            <button class="modal-close" id="closeHistoryModal" aria-label="Cerrar historial">&times;</button>
            <h2 id="historyTitle"></h2>
            <div id="historyList" class="history-list"></div>
            <div style="margin-top:12px;display:flex;gap:8px;justify-content:flex-end">
                <button id="closeHistoryBtn" class="ghost small">Cerrar</button>
            </div>
        </div>
    </div>

    <div class="toast-container" id="toastContainer" aria-live="polite" aria-atomic="true"></div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
    
    <script src="app.js"></script>
</body>
</html>